<!DOCTYPE HTML>
<html>

<head>
    <title>Agent Registration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="" />
    <script type="applijewelleryion/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
    <link href="css/bootstrap.css" rel='stylesheet' type='text/css' />
    <link href="css/style.css" rel='stylesheet' type='text/css' />
    <link href='#css?family=Open+Sans:400,700,600' rel='stylesheet' type='text/css'>
    <link href='#css?family=Roboto+Condensed:400,700,300' rel='stylesheet' type='text/css'>
    <link href='#css?family=Oswald' rel='stylesheet' type='text/css'>
    <link href="css/font-awesome.css" rel="stylesheet">
    <!-- Custom Theme files -->
    <script src="jquery/jquery-3.6.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!--animate-->
    <link href="css/animate.css" rel="stylesheet" type="text/css" media="all">
    <script src="js/wow.min.js"></script>
    <script>
        new WOW().init();
    </script>
    <!--//end-animate-->
    <style type="text/css">
        input {
            width: 200px;
            height: 40px;
            margin: 10px;
            border: 1px solid #ccc;
            padding: 5px 0px;
            border-radius: 5px;
            padding-left: 5px;
            -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
            box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
            -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;
            -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
            transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s
        }

        input:focus {
            border-color: #4db321;
            outline: 0;
            -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px rgba(102, 175, 233, .6);
            box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px rgba(102, 175, 233, .6)
        }
    </style>

</head>

<body>
<!-- top-header -->
<iframe name="frame" src="top.html" frameborder="0"  width="100%" height="145.5px" style="display: flex" ></iframe>

<!--- banner-1 ---->
<div class="banner-1">
    <div class="container">
        <h1 class="wow zoomIn animated animated" data-wow-delay=".5s" style="visibility: visible; animation-delay: 0.5s; animation-name: zoomIn;">生  &nbsp; 活 &nbsp;  与&nbsp;   美&nbsp;   好   &nbsp;尽   &nbsp;在   &nbsp;这 &nbsp;  里</h1>
    </div>
</div>
<!--- /banner-1 ---->
<!--- agent ---->
<div class="agent">
    <div class="container">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title" style="text-align: center">个人信息</h3>
                <div class="col-lg-11" id="maijia">
            </div>
                <div class="col-lg-12">
                <button type="button" style="float: right;margin-top: -40px;"   class="btn btn-success" onclick="chargeDialog()">充值</button>
                </div>
                </div>
            <div class="panel-body">
                <div class="self-info-item">
                    <div class="self-info-item-left">登录名：</div>
                    <div class="self-info-item-right">
                        <div>
                            <td>
                                <input id="userId" type="hidden">
                                <input id="userName"  name="username" type="text" class="self-info-item-right-root" >
                            </td>
                        </div>
                    </div>
                </div>
                <div class="self-info-item">
                    <div class="self-info-item-left">身份证：</div>
                    <div class="self-info-item-right">
                        <div>
                            <td>
                                <input id="userIdcard" name="useridcard" type="text" class="self-info-item-right-root" >
                            </td>
                        </div>
                    </div>
                </div>
                <div class="self-info-item">
                    <div class="self-info-item-left">手机号：</div>
                    <div class="self-info-item-right">
                        <div>
                            <td>
                                <input id="userPhoneNumber" name="userphonenumber" type="text" class="self-info-item-right-root" >
                            <td>
                        </div>
                    </div>
                </div>
                <div class="self-info-item">
                    <div class="self-info-item-left">密码：</div>
                    <div class="self-info-item-right">
                        <div>
                            <td>
                                <input id="userPwd"  type="text" class="self-info-item-right-root" >
                            </td>
                        </div>
                    </div>
                </div>
                <div class="self-info-item">
                    <div class="self-info-item-left">地址：</div>
                    <div class="self-info-item-right">
                        <div>
                            <td>
                                <input id="userAdr" name="useradr" type="text" class="self-info-item-right-root" >
                            </td>
                        </div>
                    </div>
                </div>
                <div class="self-info-item">
                    <div class="self-info-item-left">钱包余额</div>
                    <div class="self-info-item-right">
                        <div class="self-info-item-right-root" id="userWallet"></div>
                    </div>
                </div>

                <button id="updateBtn"style="display:block;margin:0 auto"  class="btn btn-success" type="button">确认修改</button>
                <!--<div class="self-info-item">-->
                <!--<div class="self-info-item-right">-->
                <!--<div class="self-info-item-right-edit">编辑</div>-->
                <!--</div>-->
                <!--</div>-->
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="myWallet" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <section>
                <div class="modal-body modal-spa">
                    <div class="login-grids">
                        <div class="login">
                            <div class="login-right">
                                <form>
                                    <h3 style="text-align:center">充值界面</h3>
                                    <input type="text" placeholder="请输入充值金额"id="money">
                                    <button type="button" onclick="charge()" >确定充值</button>
                                </form>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>
<!-- 删除模态框 -->
<div class="modal fade" id="sellerDialog" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">提示</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>您确定要成为商家吗？<br>(将会扣除500元作为抵押费)</p>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="seller()">确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 删除模态框结束 -->
<script>
    var str=sessionStorage.getItem("info");
    var user=JSON.parse(str);
    var userId=user.userId;
    function init()
    {
        console.log(userId);
        jQuery.post("user/findById",{"userId":userId},function (rst) {
            console.log(rst.userPhoneNumber);
            $("#userName").val(rst.userName);
            $("#userIdcard").val(rst.userIdcard);
            $("#userPhoneNumber").val(rst.userPhoneNumber);
            $("#userAdr").val(rst.userAdr);
            $("#userId").val(rst.userId);
            $("#userWallet").html('￥' + rst.userWallet + '元');

            sessionStorage.setItem("info",JSON.stringify(rst));
            if(rst.userStatus == 0){
                var info=`<button type="button" style="float: right;margin-top: -40px;"   class="btn btn-success" onclick="SellerDialog()">申请成为卖家</button>`
                jQuery("#maijia").html(info);
            }
            else{
                var info=`<button type="button" style="float: right;margin-top: -40px;"   class="btn btn-success" onclick="myhouse()">查看我的房源</button>`
                jQuery("#maijia").html(info);
            }
        })

    }
    jQuery(function () {
        init();
    })
    jQuery("#updateBtn").click(function() {
        var userName = $("#userName").val();
        var userIdcard = $("#userIdcard").val();
        var userPhoneNumber = $("#userPhoneNumber").val();
        var userAdr = $("#userAdr").val();
        var userId = $("#userId").val();
        if (userName == '' || userAdr == '' || userPhoneNumber == ''||userIdcard=='') {
            alert("必填项请填写完整");
            return;
        }
        let user1 = {
            "userName": userName,
            "userPhoneNumber": userPhoneNumber,
            "userIdcard": userIdcard,
            "userAdr": userAdr,
            "userId": userId
        }
        $.post("user/update", user1, function(rst) {
            console.log(rst);
            if (rst==1) {
                var u1={
                    "blogPublisherId":user1.userId,
                    "blogPublisherName":user1.userName,
                    "blogPublisherPhoneNumber":user1.userPhoneNumber
                }
                jQuery.post("blogmsg/updateUser",u1,function (rst1) {

                })
                if(user.userStatus==1){
                    var u2={
                        "houseSellerId":user1.userId,
                        "houseSellerName":user1.userName,
                        "houseSellerPhoneNumber":user1.userPhoneNumber
                    }
                    jQuery.post("housemsg/updateUser",u2,function (rst2) {

                    })
                }
                alert('更改成功');
                location.href="userInfo.html";
            } else {
                alert('更改失败')
            }
        });
    })
    function chargeDialog() {

        jQuery("#myWallet").modal('show');
    }
    function charge() {
        var userWallet=jQuery("#money").val();
        var user={
            "userId":userId,
            "userWallet":userWallet
        }
        $.post("user/userCharge",user,function (rst) {
            jQuery("#myWallet").modal('hide');
            console.log(user.userWallet);
            if(rst==1){
                alert('充值成功');
                location.href="userInfo.html";
            }
            else{
                alert('充值失败');
            }
        })
    }
    function SellerDialog() {
        jQuery("#sellerDialog").modal('show');
    }
    function seller() {
        var str=sessionStorage.getItem("info");
        var user=JSON.parse(str);
        var userWallet=user.userWallet;
        if(userWallet<500.0){
            alert("您钱包的余额不足请充值！");
            jQuery("#sellerDialog").modal('hide');
        }
        else{
            jQuery.post("user/seller",{"userId":userId},function (rst) {
                jQuery("#sellerDialog").modal('hide');
                    if(rst==1){
                        alert("申请成功");
                        location.href="userInfo.html";
                    }
                    else{
                        alert("申请失败");
                    }
            })
        }
    }
    function myhouse() {
        location.href="myhouse.html";
    }
</script>
<!--- /agent ---->
<!--- footer-top ---->
<!--- /footer-top ---->
<!---copy-right ---->
<div class="copy-right">
    <div class="container">

        <div class="footer-social-icons wow fadeInDown animated animated" data-wow-delay=".5s" style="visibility: visible; animation-delay: 0.5s; animation-name: fadeInDown;">
            <ul>
                <li><a class="facebook" href="#"><span>Facebook</span></a></li>
                <li><a class="twitter" href="#"><span>Twitter</span></a></li>
                <li><a class="flickr" href="#"><span>Flickr</span></a></li>
                <li><a class="googleplus" href="#"><span>Google+</span></a></li>
                <li><a class="dribbble" href="#"><span>Dribbble</span></a></li>
            </ul>
        </div>
        <p class="wow zoomIn animated animated" data-wow-delay=".5s" style="visibility: visible; animation-delay: 0.5s; animation-name: zoomIn;">© 2016 Green Wheels . All Rights Reserved | Design by <a href="http://w3layouts.com/" target="_blank">W3layouts</a> </p>
    </div>
</div>
<!--- /copy-right ---->

</body>

</html>